<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON ROULETTE MASTER</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --neon-cyan: #0ff0fc;
            --neon-green: #00ff9d;
            --dark-bg: #0a0a0f;
            --darker-bg: #050508;
            --card-bg: #11111a;
        }
        
        body {
            background-color: var(--dark-bg);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
        }
        
        .neon-cyan {
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
        }
        
        .neon-green {
            color: var(--neon-green);
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.5);
        }
        
        .neon-border {
            border: 2px solid var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 240, 252, 0.3);
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(0, 240, 252, 0.5);
        }
        
        .chip-shadow {
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.7));
        }
        
        .phase-1 { border-left: 5px solid #ff6b6b; }
        .phase-2 { border-left: 5px solid #ffd93d; }
        .phase-3 { border-left: 5px solid #6bcf7f; }
        .phase-4 { border-left: 5px solid #ff8e6b; }
        
        .red-roulette { background-color: #d32f2f; }
        .black-roulette { background-color: #212121; }
        .green-roulette { background-color: #2e7d32; }
        
        .red-roulette:hover { background-color: #f44336; }
        .black-roulette:hover { background-color: #424242; }
        .green-roulette:hover { background-color: #4caf50; }
        
        .history-item {
            transition: all 0.3s ease;
        }
        
        .history-item:hover {
            transform: scale(1.05);
        }
        
        .progress-bar {
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            background-color: #333;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-green));
            transition: width 0.5s ease;
        }
        
        .phase-badge {
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .chip {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: black;
            margin: 3px;
            transition: transform 0.2s;
        }
        
        .chip:hover {
            transform: scale(1.1);
        }
        
        .chip-500 { background-color: #ff9800; }
        .chip-2500 { background-color: #2196f3; }
        .chip-5000 { background-color: #4caf50; }
        .chip-25000 { background-color: #9c27b0; }
        .chip-100000 { background-color: #f44336; }
        .chip-500000 { background-color: #ffeb3b; color: #333; }
        .chip-1200000 { background-color: #00bcd4; }
        .chip-5000000 { background-color: #795548; }
        
        @media (max-width: 640px) {
            .chip {
                width: 40px;
                height: 40px;
                font-size: 12px;
            }
        }
        
        /* Animaciones */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 240, 252, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(0, 240, 252, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 240, 252, 0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(16, 16, 26, 0.9), rgba(10, 10, 15, 0.9));
            border: 1px solid rgba(0, 240, 252, 0.2);
            border-radius: 12px;
        }
        
        .prediction-high {
            background: linear-gradient(135deg, rgba(0, 255, 157, 0.1), rgba(0, 240, 252, 0.1));
            border: 2px solid var(--neon-green);
        }
        
        .prediction-low {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 142, 107, 0.1));
            border: 2px solid #ff6b6b;
        }
        
        .calibration-phase { background: linear-gradient(135deg, rgba(255, 217, 61, 0.1), rgba(255, 193, 7, 0.1)); border-color: #ffd93d; }
        .ghost-phase { background: linear-gradient(135deg, rgba(155, 81, 224, 0.1), rgba(103, 58, 183, 0.1)); border-color: #9b51e0; }
        .active-phase { background: linear-gradient(135deg, rgba(0, 255, 157, 0.1), rgba(0, 200, 83, 0.1)); border-color: var(--neon-green); }
        .protection-phase { background: linear-gradient(135deg, rgba(255, 87, 87, 0.1), rgba(244, 67, 54, 0.1)); border-color: #ff5757; }
    </style>
</head>
<body class="min-h-screen p-4">
    <div class="max-w-6xl mx-auto">
        <!-- Encabezado -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold neon-cyan mb-2">NEON ROULETTE MASTER</h1>
            <p class="text-lg text-gray-300 mb-4">Sistema de predicción matemática para ruleta europea</p>
            
            <div class="flex flex-wrap justify-center gap-4 mb-6">
                <div class="stat-card p-3 min-w-[180px]">
                    <div class="text-sm text-gray-400">Fase Actual</div>
                    <div id="currentPhase" class="text-xl font-bold neon-green">Fase 1: Recolección</div>
                </div>
                
                <div class="stat-card p-3 min-w-[180px]">
                    <div class="text-sm text-gray-400">Saldo</div>
                    <div id="currentBalance" class="text-xl font-bold">$10,000</div>
                </div>
                
                <div class="stat-card p-3 min-w-[180px]">
                    <div class="text-sm text-gray-400">Precisión</div>
                    <div id="accuracy" class="text-xl font-bold">0%</div>
                </div>
            </div>
        </header>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Panel izquierdo: Control y Fichas -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Panel de Control -->
                <div class="stat-card p-5 neon-border fade-in">
                    <h2 class="text-2xl font-bold neon-cyan mb-4 flex items-center">
                        <i class="fas fa-sliders-h mr-2"></i> Panel de Control
                    </h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-300 mb-2">Capital Inicial ($)</label>
                            <input type="number" id="initialCapital" value="10000" min="100" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        </div>
                        
                        <div>
                            <label class="block text-gray-300 mb-2">Meta de Ganancia ($)</label>
                            <input type="number" id="profitTarget" value="15000" min="100" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        </div>
                        
                        <div>
                            <label class="block text-gray-300 mb-2">Stop Loss ($)</label>
                            <input type="number" id="stopLoss" value="5000" min="100" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        </div>
                        
                        <div>
                            <label class="block text-gray-300 mb-2">Progreso hacia la Meta</label>
                            <div class="progress-bar mt-2">
                                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <div class="flex justify-between text-sm text-gray-400 mt-1">
                                <span id="currentProgress">$10,000</span>
                                <span id="targetProgress">$15,000</span>
                            </div>
                        </div>
                        
                        <button id="updateSettings" class="w-full bg-gradient-to-r from-cyan-600 to-green-600 hover:from-cyan-700 hover:to-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fas fa-sync-alt mr-2"></i> Actualizar Configuración
                        </button>
                    </div>
                </div>
                
                <!-- Fichas Inteligentes -->
                <div class="stat-card p-5 neon-border fade-in">
                    <h2 class="text-2xl font-bold neon-green mb-4 flex items-center">
                        <i class="fas fa-coins mr-2"></i> Fichas Inteligentes
                    </h2>
                    
                    <div class="mb-4">
                        <div class="text-gray-300 mb-2">Apuesta Calculada:</div>
                        <div id="currentBet" class="text-3xl font-bold neon-cyan text-center">$0</div>
                    </div>
                    
                    <div class="text-gray-300 mb-3">Composición de fichas:</div>
                    <div id="chipComposition" class="flex flex-wrap justify-center gap-2 mb-6">
                        <div class="text-gray-500 text-center py-4">Ingresa números para calcular la apuesta</div>
                    </div>
                    
                    <div class="text-gray-300 mb-3">Valores de fichas disponibles:</div>
                    <div class="flex flex-wrap justify-center gap-2">
                        <div class="chip chip-500">500</div>
                        <div class="chip chip-2500">2.5K</div>
                        <div class="chip chip-5000">5K</div>
                        <div class="chip chip-25000">25K</div>
                        <div class="chip chip-100000">100K</div>
                        <div class="chip chip-500000">500K</div>
                        <div class="chip chip-1200000">1.2M</div>
                        <div class="chip chip-5000000">5M</div>
                    </div>
                </div>
                
                <!-- Controles -->
                <div class="stat-card p-5 neon-border fade-in">
                    <h2 class="text-2xl font-bold neon-cyan mb-4 flex items-center">
                        <i class="fas fa-cogs mr-2"></i> Controles
                    </h2>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <button id="changeDealer" class="bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 flex flex-col items-center justify-center">
                            <i class="fas fa-user-secret text-2xl mb-2"></i>
                            <span>Cambiar Crupier</span>
                        </button>
                        
                        <button id="undoLast" class="bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 flex flex-col items-center justify-center">
                            <i class="fas fa-undo text-2xl mb-2"></i>
                            <span>Deshacer</span>
                        </button>
                        
                        <button id="exportData" class="col-span-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 flex items-center justify-center">
                            <i class="fas fa-file-export mr-2"></i>
                            <span>Exportar Datos (JSON)</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Panel central: Teclado y Predicciones -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Predicción Actual -->
                <div class="stat-card p-5 neon-border fade-in">
                    <h2 class="text-2xl font-bold neon-green mb-4 flex items-center">
                        <i class="fas fa-brain mr-2"></i> Predicción del Sistema
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="text-gray-400 mb-2">Docena Predicha:</div>
                            <div id="predictedDozen" class="text-4xl font-bold neon-cyan text-center py-4">-</div>
                            <div class="text-gray-400 text-sm text-center">(Basado en análisis de tendencias)</div>
                        </div>
                        
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="text-gray-400 mb-2">Confianza:</div>
                            <div id="confidenceLevel" class="text-4xl font-bold text-center py-4">-</div>
                            <div class="text-gray-400 text-sm text-center">Nivel de certeza del algoritmo</div>
                        </div>
                    </div>
                    
                    <div class="mt-4 bg-gray-800 rounded-lg p-4">
                        <div class="text-gray-400 mb-2">Números Recomendados:</div>
                        <div id="recommendedNumbers" class="text-xl font-bold text-center py-2 text-green-400">Esperando datos...</div>
                        <div class="text-gray-400 text-sm text-center">Mejores opciones según el algoritmo</div>
                    </div>
                    
                    <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="text-gray-400 mb-1">Docena Caliente</div>
                            <div id="hotDozen" class="text-2xl font-bold text-yellow-400">-</div>
                            <div class="text-gray-500 text-xs">Más frecuente</div>
                        </div>
                        
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="text-gray-400 mb-1">Docena Fría</div>
                            <div id="coldDozen" class="text-2xl font-bold text-blue-400">-</div>
                            <div class="text-gray-500 text-xs">Menos frecuente</div>
                        </div>
                        
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="text-gray-400 mb-1">Último Acierto</div>
                            <div id="lastHit" class="text-2xl font-bold text-green-400">-</div>
                            <div class="text-gray-500 text-xs">Hace X tiros</div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 rounded-lg" id="phaseMessage">
                        <div class="flex items-center">
                            <i class="fas fa-info-circle text-cyan-400 mr-3 text-xl"></i>
                            <div>
                                <div class="font-bold neon-cyan">Fase 1: Recolección de Datos</div>
                                <div class="text-gray-300">Por favor, ingresa los primeros 37 números para calibrar el sistema.</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Teclado Numérico -->
                <div class="stat-card p-5 neon-border fade-in">
                    <h2 class="text-2xl font-bold neon-cyan mb-4 flex items-center">
                        <i class="fas fa-keyboard mr-2"></i> Teclado de Ruleta
                    </h2>
                    
                    <div class="mb-6 text-center">
                        <div class="text-gray-300 mb-2">Números ingresados: <span id="numbersEnteredCount">0</span>/37 (Fase 1)</div>
                        <div class="progress-bar mx-auto max-w-md">
                            <div id="numbersProgress" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-4 sm:grid-cols-7 md:grid-cols-8 lg:grid-cols-9 gap-3" id="keyboardContainer">
                        <!-- Los botones del 0 al 36 se generarán dinámicamente -->
                    </div>
                    
                    <div class="mt-6 flex justify-center gap-4">
                        <button id="clearAll" class="bg-red-800 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            <i class="fas fa-trash-alt mr-2"></i> Limpiar Todo
                        </button>
                        
                        <button id="simulateRandom" class="bg-blue-800 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            <i class="fas fa-dice mr-2"></i> Simular Aleatorio
                        </button>
                    </div>
                </div>
                
                <!-- Historial -->
                <div class="stat-card p-5 neon-border fade-in">
                    <h2 class="text-2xl font-bold neon-green mb-4 flex items-center">
                        <i class="fas fa-history mr-2"></i> Historial de Tiradas
                    </h2>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="text-gray-400 border-b border-gray-800">
                                    <th class="py-2 text-left">#</th>
                                    <th class="py-2 text-left">Número</th>
                                    <th class="py-2 text-left">Color</th>
                                    <th class="py-2 text-left">Docena</th>
                                    <th class="py-2 text-left">Predicción</th>
                                    <th class="py-2 text-left">Resultado</th>
                                    <th class="py-2 text-left">Apuesta</th>
                                    <th class="py-2 text-left">Saldo</th>
                                </tr>
                            </thead>
                            <tbody id="historyBody">
                                <tr>
                                    <td colspan="8" class="text-center py-8 text-gray-500">No hay historial aún. Ingresa números para comenzar.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-4 flex justify-between text-sm text-gray-400">
                        <div>Total tiradas: <span id="totalSpins">0</span></div>
                        <div>Aciertos: <span id="totalHits">0</span> (<span id="hitPercentage">0</span>%)</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="mt-10 text-center text-gray-500 text-sm border-t border-gray-800 pt-6">
            <p class="neon-cyan font-bold">NEON ROULETTE MASTER V1 - Sistema de Predicción Matemática</p>
            <p class="mt-2">Algoritmo basado en la Ley del Tercio y gestión D'Alembert • Solo para fines educativos</p>
            <p class="mt-2">© 2023 - Todos los derechos reservados</p>
        </footer>
    </div>

    <!-- Cargar el cerebro matemático -->
    <script src="brain.js"></script>
    
    <script>
        // ============================================
        // INTERFAZ DE USUARIO - CONTROLADOR
        // ============================================
        
        // Valores de fichas disponibles
        const chipValues = [500, 2500, 5000, 25000, 100000, 500000, 1200000, 5000000];
        
        // Colores de la ruleta
        const rouletteColors = {
            0: 'green',
            32: 'red', 19: 'red', 21: 'red', 25: 'red', 34: 'red', 27: 'red', 36: 'red', 30: 'red', 23: 'red', 5: 'red', 16: 'red', 1: 'red', 14: 'red', 9: 'red', 18: 'red', 7: 'red', 12: 'red', 3: 'red',
            15: 'black', 4: 'black', 2: 'black', 17: 'black', 6: 'black', 13: 'black', 11: 'black', 8: 'black', 10: 'black', 24: 'black', 33: 'black', 20: 'black', 31: 'black', 22: 'black', 29: 'black', 28: 'black', 35: 'black', 26: 'black'
        };

        // Estado de la interfaz
        const uiState = {
            lastNumber: null,
            history: [],
            chipComposition: []
        };

        // ============================================
        // INICIALIZACIÓN
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar cerebro matemático con saldo inicial
            NEON_CORE.init(10000);
            
            // Cargar estado guardado
            loadState();
            
            // Crear teclado numérico
            initializeKeyboard();
            
            // Actualizar interfaz
            updateUI();
            
            // Configurar event listeners
            setupEventListeners();
        });

        // Cargar estado desde localStorage
        function loadState() {
            const savedState = localStorage.getItem('neonRouletteUIState');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                Object.assign(uiState, parsed);
                
                // Restaurar historial en el cerebro
                if (uiState.history.length > 0) {
                    // El cerebro ya maneja su propio historial, así que solo actualizamos UI
                    console.log('Estado de UI cargado desde localStorage');
                }
            }
        }

        // Guardar estado en localStorage
        function saveState() {
            localStorage.setItem('neonRouletteUIState', JSON.stringify(uiState));
        }

        // Inicializar teclado numérico
        function initializeKeyboard() {
            const keyboard = document.getElementById('keyboardContainer');
            keyboard.innerHTML = '';
            
            // Botón para el 0 (verde)
            createNumberButton(0, keyboard);
            
            // Botones para los números 1-36
            for (let i = 1; i <= 36; i++) {
                createNumberButton(i, keyboard);
            }
        }

        // Crear botón para número
        function createNumberButton(number, container) {
            const button = document.createElement('button');
            button.className = `py-4 rounded-lg font-bold text-xl transition duration-300 transform hover:scale-105 ${getNumberColorClass(number)}`;
            button.textContent = number;
            button.dataset.number = number;
            
            button.addEventListener('click', () => {
                processNumber(number);
            });
            
            container.appendChild(button);
        }

        // Obtener clase CSS para el color del número
        function getNumberColorClass(number) {
            const color = rouletteColors[number] || 'black';
            return `${color}-roulette`;
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Actualizar configuración
            document.getElementById('updateSettings').addEventListener('click', updateSettings);
            
            // Cambiar crupier
            document.getElementById('changeDealer').addEventListener('click', changeDealer);
            
            // Deshacer última jugada
            document.getElementById('undoLast').addEventListener('click', undoLast);
            
            // Exportar datos
            document.getElementById('exportData').addEventListener('click', exportData);
            
            // Limpiar todo
            document.getElementById('clearAll').addEventListener('click', clearAll);
            
            // Simular aleatorio
            document.getElementById('simulateRandom').addEventListener('click', simulateRandom);
        }

        // ============================================
        // FUNCIONES PRINCIPALES DE LA INTERFAZ
        // ============================================

        // Procesar un número (conexión con el cerebro)
        function processNumber(number) {
            // Guardar número actual
            uiState.lastNumber = number;
            
            // Enviar al cerebro para procesamiento
            const result = NEON_CORE.processSpin(number);
            
            // Guardar en historial de UI
            const historyEntry = {
                number: number,
                result: result,
                timestamp: new Date().toLocaleTimeString(),
                color: rouletteColors[number]
            };
            
            uiState.history.unshift(historyEntry);
            
            // Guardar estado y actualizar UI
            saveState();
            updateUI();
            
            // Mostrar efecto visual en el botón
            highlightNumberButton(number);
            
            // Mostrar mensaje según resultado
            showResultMessage(result, number);
        }

        // Actualizar toda la interfaz
        function updateUI() {
            // Obtener estado actual del cerebro
            const coreState = NEON_CORE.getState();
            
            // Actualizar contadores
            document.getElementById('numbersEnteredCount').textContent = coreState.history.length;
            document.getElementById('totalSpins').textContent = coreState.history.length;
            
            // Actualizar barra de progreso de números
            const numbersProgress = Math.min(100, (coreState.history.length / 37) * 100);
            document.getElementById('numbersProgress').style.width = numbersProgress + '%';
            
            // Actualizar saldo
            document.getElementById('currentBalance').textContent = '$' + coreState.balance.toLocaleString();
            
            // Actualizar precisión
            const accuracy = NEON_CORE.getAccuracy();
            document.getElementById('accuracy').textContent = accuracy + '%';
            
            // Actualizar fase
            updatePhaseDisplay(coreState.phase);
            
            // Actualizar progreso hacia la meta
            updateProgressBar(coreState.balance);
            
            // Actualizar predicciones
            updatePredictions(coreState);
            
            // Actualizar apuesta y fichas
            updateBetDisplay(coreState.currentBet);
            
            // Actualizar historial
            updateHistory();
            
            // Actualizar estadísticas
            updateStatsDisplay(coreState);
        }

        // Actualizar visualización de fase
        function updatePhaseDisplay(phase) {
            const phaseNames = {
                'CALIBRATION': 'Fase 1: Recolección',
                'GHOST': 'Fase 2: Calibración',
                'ACTIVE': 'Fase 3: Fuego Real',
                'PROTECTION': 'Fase 4: Protección'
            };
            
            const phaseColors = {
                'CALIBRATION': 'text-red-400',
                'GHOST': 'text-yellow-400',
                'ACTIVE': 'text-green-400',
                'PROTECTION': 'text-orange-400'
            };
            
            const phaseElement = document.getElementById('currentPhase');
            phaseElement.textContent = phaseNames[phase] || phase;
            phaseElement.className = `text-xl font-bold ${phaseColors[phase] || 'text-gray-400'}`;
        }

        // Actualizar barra de progreso hacia la meta
        function updateProgressBar(currentBalance) {
            const progressFill = document.getElementById('progressFill');
            const currentProgress = document.getElementById('currentProgress');
            const targetProgress = document.getElementById('targetProgress');
            
            const initialCapital = parseInt(document.getElementById('initialCapital').value) || 10000;
            const profitTarget = parseInt(document.getElementById('profitTarget').value) || 15000;
            const current = currentBalance;
            
            // Calcular progreso normalizado (0% a 100%)
            let progressPercent = 0;
            if (profitTarget > initialCapital) {
                progressPercent = ((current - initialCapital) / (profitTarget - initialCapital)) * 100;
            }
            
            // Limitar entre 0% y 100%
            progressPercent = Math.max(0, Math.min(100, progressPercent));
            
            progressFill.style.width = progressPercent + '%';
            currentProgress.textContent = '$' + current.toLocaleString();
            targetProgress.textContent = '$' + profitTarget.toLocaleString();
        }

        // Actualizar predicciones en UI
        function updatePredictions(coreState) {
            // Obtener predicción actual
            const prediction = NEON_CORE.getCurrentPrediction();
            
            // Actualizar docena predicha
            const predictedDozenElement = document.getElementById('predictedDozen');
            const confidenceElement = document.getElementById('confidenceLevel');
            
            if (prediction && prediction.dozen) {
                predictedDozenElement.textContent = `Docena ${prediction.dozen}`;
                confidenceElement.textContent = `${prediction.confidence || 0}%`;
                
                // Color según confianza
                if (prediction.confidence >= 75) {
                    predictedDozenElement.className = "text-4xl font-bold text-green-400 text-center py-4 pulse";
                    confidenceElement.className = "text-4xl font-bold text-green-400 text-center py-4";
                } else if (prediction.confidence >= 50) {
                    predictedDozenElement.className = "text-4xl font-bold text-yellow-400 text-center py-4";
                    confidenceElement.className = "text-4xl font-bold text-yellow-400 text-center py-4";
                } else {
                    predictedDozenElement.className = "text-4xl font-bold text-gray-400 text-center py-4";
                    confidenceElement.className = "text-4xl font-bold text-gray-400 text-center py-4";
                }
            } else {
                predictedDozenElement.textContent = "-";
                predictedDozenElement.className = "text-4xl font-bold text-gray-500 text-center py-4";
                confidenceElement.textContent = "-";
                confidenceElement.className = "text-4xl font-bold text-gray-500 text-center py-4";
            }
            
            // Actualizar números recomendados
            const recommendedNumbersElement = document.getElementById('recommendedNumbers');
            if (prediction && prediction.numbers && prediction.numbers.length > 0) {
                recommendedNumbersElement.textContent = prediction.numbers.slice(0, 6).join(', ');
                recommendedNumbersElement.className = "text-xl font-bold text-center py-2 text-green-400";
            } else {
                recommendedNumbersElement.textContent = "Esperando datos...";
                recommendedNumbersElement.className = "text-xl font-bold text-center py-2 text-gray-500";
            }
        }

        // Actualizar estadísticas en UI
        function updateStatsDisplay(coreState) {
            const stats = NEON_CORE.getStats();
            
            if (stats) {
                document.getElementById('hotDozen').textContent = stats.hotDozen ? 
                    `Docena ${stats.hotDozen}` : "-";
                document.getElementById('coldDozen').textContent = stats.coldDozen ? 
                    `Docena ${stats.coldDozen}` : "-";
            }
            
            // Último acierto
            const lastHitElement = document.getElementById('lastHit');
            if (uiState.history.length > 0) {
                const lastHit = uiState.history.find(entry => 
                    entry.result && entry.result.lastResult && entry.result.lastResult.won);
                if (lastHit) {
                    lastHitElement.textContent = `#${lastHit.number}`;
                } else {
                    lastHitElement.textContent = "Ninguno";
                }
            } else {
                lastHitElement.textContent = "-";
            }
        }

        // Actualizar visualización de apuesta y fichas
        function updateBetDisplay(currentBet) {
            // Actualizar monto de apuesta
            const currentBetElement = document.getElementById('currentBet');
            const coreState = NEON_CORE.getState();
            
            if (coreState.phase === 'ACTIVE' && currentBet > 0) {
                currentBetElement.textContent = '$' + currentBet.toLocaleString();
                currentBetElement.className = "text-3xl font-bold neon-cyan text-center";
            } else {
                currentBetElement.textContent = 'Modo Prueba';
                currentBetElement.className = "text-3xl font-bold text-gray-500 text-center";
            }
            
            // Actualizar composición de fichas
            updateChipComposition(currentBet);
        }

        // Actualizar composición de fichas
        function updateChipComposition(betAmount) {
            const chipCompositionElement = document.getElementById('chipComposition');
            const coreState = NEON_CORE.getState();
            
            if (coreState.phase !== 'ACTIVE' || betAmount <= 0) {
                chipCompositionElement.innerHTML = '<div class="text-gray-500 text-center py-4">Ingresa números para calcular la apuesta</div>';
                return;
            }
            
            // Calcular qué fichas usar para la apuesta actual
            let remaining = betAmount;
            const chipsUsed = [];
            
            // Ordenar fichas de mayor a menor valor
            const sortedChips = [...chipValues].sort((a, b) => b - a);
            
            for (const chipValue of sortedChips) {
                if (remaining >= chipValue) {
                    const count = Math.floor(remaining / chipValue);
                    for (let i = 0; i < count; i++) {
                        chipsUsed.push(chipValue);
                    }
                    remaining %= chipValue;
                }
            }
            
            // Si queda un resto, añadir una ficha más pequeña
            if (remaining > 0) {
                for (const chipValue of sortedChips.slice().reverse()) {
                    if (chipValue >= remaining) {
                        chipsUsed.push(chipValue);
                        break;
                    }
                }
            }
            
            // Generar HTML para las fichas
            if (chipsUsed.length === 0) {
                chipCompositionElement.innerHTML = '<div class="text-gray-500 text-center py-4">Apuesta demasiado pequeña para fichas disponibles</div>';
            } else {
                chipCompositionElement.innerHTML = '';
                chipsUsed.forEach(chipValue => {
                    const chipElement = document.createElement('div');
                    chipElement.className = `chip chip-${chipValue} chip-shadow`;
                    chipElement.textContent = chipValue >= 1000000 ? 
                        (chipValue / 1000000) + 'M' : 
                        chipValue >= 1000 ? 
                        (chipValue / 1000) + 'K' : 
                        chipValue;
                    chipElement.title = `$${chipValue.toLocaleString()}`;
                    chipCompositionElement.appendChild(chipElement);
                });
            }
        }

        // Actualizar historial en UI
        function updateHistory() {
            const historyBody = document.getElementById('historyBody');
            const totalHitsElement = document.getElementById('totalHits');
            const hitPercentageElement = document.getElementById('hitPercentage');
            
            if (uiState.history.length === 0) {
                historyBody.innerHTML = '<tr><td colspan="8" class="text-center py-8 text-gray-500">No hay historial aún. Ingresa números para comenzar.</td></tr>';
                totalHitsElement.textContent = '0';
                hitPercentageElement.textContent = '0';
                return;
            }
            
            // Calcular estadísticas
            const totalHits = uiState.history.filter(entry => 
                entry.result && entry.result.lastResult && entry.result.lastResult.won).length;
            const hitPercentage = uiState.history.length > 0 ? 
                ((totalHits / uiState.history.length) * 100).toFixed(1) : '0';
            
            totalHitsElement.textContent = totalHits;
            hitPercentageElement.textContent = hitPercentage;
            
            // Generar filas de historial (mostrar las últimas 15)
            const recentHistory = uiState.history.slice(0, 15);
            historyBody.innerHTML = '';
            
            recentHistory.forEach((entry, index) => {
                const row = document.createElement('tr');
                row.className = `history-item border-b border-gray-800 hover:bg-gray-800/50 ${index % 2 === 0 ? 'bg-gray-900/30' : ''}`;
                
                const dozen = entry.number === 0 ? 0 : Math.ceil(entry.number / 12);
                const prediction = entry.result && entry.result.prediction ? 
                    `Docena ${entry.result.prediction.dozen || '-'}` : '-';
                const won = entry.result && entry.result.lastResult ? entry.result.lastResult.won : false;
                const bet = entry.result ? entry.result.bet : 0;
                const balance = entry.result ? entry.result.balance : 0;
                
                row.innerHTML = `
                    <td class="py-3">${uiState.history.length - index}</td>
                    <td class="py-3">
                        <span class="inline-block w-8 h-8 rounded-full text-center leading-8 font-bold ${entry.color}-roulette">
                            ${entry.number}
                        </span>
                    </td>
                    <td class="py-3">
                        <span class="capitalize">${entry.color}</span>
                    </td>
                    <td class="py-3">${dozen > 0 ? 'Docena ' + dozen : 'Cero'}</td>
                    <td class="py-3">${prediction}</td>
                    <td class="py-3">
                        <span class="${won ? 'text-green-400' : 'text-red-400'} font-bold">
                            ${won ? '✓ ACIERTO' : '✗ FALLO'}
                        </span>
                    </td>
                    <td class="py-3">${bet > 0 ? '$' + bet.toLocaleString() : '-'}</td>
                    <td class="py-3 ${balance >= 10000 ? 'text-green-400' : 'text-red-400'}">
                        $${balance.toLocaleString()}
                    </td>
                `;
                
                historyBody.appendChild(row);
            });
        }

        // ============================================
        // FUNCIONES AUXILIARES DE LA INTERFAZ
        // ============================================

        // Resaltar botón de número
        function highlightNumberButton(number) {
            const button = document.querySelector(`button[data-number="${number}"]`);
            if (button) {
                button.classList.add('neon-glow');
                setTimeout(() => button.classList.remove('neon-glow'), 1000);
            }
        }

        // Mostrar mensaje de resultado
        function showResultMessage(result, number) {
            const phaseMessageElement = document.getElementById('phaseMessage');
            let message = "";
            let phaseClass = "";
            
            const coreState = NEON_CORE.getState();
            
            // Determinar clase según fase
            switch(coreState.phase) {
                case 'CALIBRATION':
                    phaseClass = 'calibration-phase';
                    message = `Número ${number} registrado. ${coreState.history.length}/37 para calibración.`;
                    break;
                case 'GHOST':
                    phaseClass = 'ghost-phase';
                    const accuracy = NEON_CORE.getAccuracy();
                    message = `Calibrando... Precisión: ${accuracy}%`;
                    break;
                case 'ACTIVE':
                    phaseClass = 'active-phase';
                    if (result.lastResult) {
                        if (result.lastResult.won) {
                            message = `¡ACIERTO! +$${(result.lastResult.amount).toLocaleString()}`;
                        } else {
                            message = `Fallo. -$${result.bet.toLocaleString()}`;
                            if (number === 0) {
                                message = `Cero (0). Pérdida congelada. -$${result.bet.toLocaleString()}`;
                            }
                        }
                    }
                    break;
                case 'PROTECTION':
                    phaseClass = 'protection-phase';
                    message = "¡3 pérdidas consecutivas! Modo protección activado.";
                    break;
            }
            
            phaseMessageElement.className = `${phaseClass} p-4 rounded-lg mt-6 fade-in`;
            phaseMessageElement.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-info-circle mr-3 text-xl"></i>
                    <div>
                        <div class="font-bold">${document.getElementById('currentPhase').textContent}</div>
                        <div class="text-gray-300">${message}</div>
                    </div>
                </div>
            `;
        }

        // ============================================
        // FUNCIONES DE CONTROL
        // ============================================

        // Actualizar configuración
        function updateSettings() {
            const initialCapital = parseInt(document.getElementById('initialCapital').value) || 10000;
            const profitTarget = parseInt(document.getElementById('profitTarget').value) || 15000;
            const stopLoss = parseInt(document.getElementById('stopLoss').value) || 5000;
            
            // Validar valores
            if (initialCapital < 100) {
                alert('El capital inicial debe ser al menos $100');
                return;
            }
            
            if (profitTarget <= initialCapital) {
                alert('La meta de ganancia debe ser mayor al capital inicial');
                return;
            }
            
            if (stopLoss >= initialCapital) {
                alert('El stop loss debe ser menor al capital inicial');
                return;
            }
            
            // Reiniciar sistema con nueva configuración
            NEON_CORE.reset();
            NEON_CORE.init(initialCapital);
            uiState.history = [];
            
            // Guardar y actualizar
            saveState();
            updateUI();
            
            alert('Configuración actualizada correctamente');
        }

        // Cambiar crupier
        function changeDealer() {
            if (confirm('¿Cambiar de crupier? Esto reiniciará el historial pero mantendrá el saldo actual.')) {
                const currentBalance = NEON_CORE.getState().balance;
                NEON_CORE.reset();
                NEON_CORE.init(currentBalance);
                uiState.history = [];
                
                saveState();
                updateUI();
                
                const phaseMessageElement = document.getElementById('phaseMessage');
                phaseMessageElement.className = 'calibration-phase p-4 rounded-lg mt-6 fade-in';
                phaseMessageElement.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-user-secret mr-3 text-xl"></i>
                        <div>
                            <div class="font-bold">¡Crupier Cambiado!</div>
                            <div class="text-gray-300">Sistema reiniciado. Comienza a ingresar números para la nueva sesión.</div>
                        </div>
                    </div>
                `;
            }
        }

        // Deshacer última jugada
        function undoLast() {
            if (uiState.history.length === 0) {
                alert('No hay números para deshacer');
                return;
            }
            
            // Eliminar última entrada
            uiState.history.shift();
            
            // Nota: No podemos deshacer fácilmente en el cerebro porque es estado interno
            // En su lugar, reiniciamos el cerebro y volvemos a procesar todo excepto el último
            const currentBalance = NEON_CORE.getState().balance;
            NEON_CORE.reset();
            NEON_CORE.init(currentBalance);
            
            // Reprocesar todos los números excepto el último
            const numbersToReprocess = uiState.history.map(entry => entry.number).reverse();
            numbersToReprocess.forEach(number => {
                NEON_CORE.processSpin(number);
            });
            
            saveState();
            updateUI();
        }

        // Exportar datos como JSON
        function exportData() {
            const coreState = NEON_CORE.getState();
            const exportObj = {
                metadata: {
                    app: "NEON ROULETTE MASTER V3",
                    exportDate: new Date().toISOString(),
                    phase: coreState.phase,
                    balance: coreState.balance,
                    accuracy: NEON_CORE.getAccuracy()
                },
                statistics: {
                    totalSpins: coreState.history.length,
                    currentBet: coreState.currentBet,
                    betLevel: coreState.betLevel,
                    historyCount: uiState.history.length
                },
                uiHistory: uiState.history
            };
            
            const dataStr = JSON.stringify(exportObj, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `neon-roulette-${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            // Mostrar mensaje de confirmación
            const phaseMessageElement = document.getElementById('phaseMessage');
            phaseMessageElement.className = 'active-phase p-4 rounded-lg mt-6 fade-in';
            phaseMessageElement.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-file-export mr-3 text-xl"></i>
                    <div>
                        <div class="font-bold">Datos Exportados</div>
                        <div class="text-gray-300">Archivo guardado como: ${exportFileDefaultName}</div>
                    </div>
                </div>
            `;
            
            setTimeout(() => updateUI(), 3000);
        }

        // Limpiar todo
        function clearAll() {
            if (confirm('¿Reiniciar completamente el sistema? Esto borrará todos los datos.')) {
                const initialCapital = parseInt(document.getElementById('initialCapital').value) || 10000;
                
                NEON_CORE.reset();
                NEON_CORE.init(initialCapital);
                uiState.history = [];
                uiState.lastNumber = null;
                
                saveState();
                updateUI();
                
                const phaseMessageElement = document.getElementById('phaseMessage');
                phaseMessageElement.className = 'calibration-phase p-4 rounded-lg mt-6 fade-in';
                phaseMessageElement.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-trash-alt mr-3 text-xl"></i>
                        <div>
                            <div class="font-bold">Sistema Reiniciado</div>
                            <div class="text-gray-300">Todos los datos han sido borrados. Comienza a ingresar números.</div>
                        </div>
                    </div>
                `;
            }
        }

        // Simular número aleatorio
        function simulateRandom() {
            const randomNumber = Math.floor(Math.random() * 37); // 0-36
            processNumber(randomNumber);
        }

        // ============================================
        // INICIALIZACIÓN FINAL
        // ============================================
        // Guardar estado antes de cerrar
        window.addEventListener('beforeunload', saveState);
    </script>
</body>
</html>
