<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEON PRECISION V18 - OFFLINE MASTER</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Orbitron', monospace;
            background: #000;
            color: #fff;
            overflow-x: hidden;
        }

        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .neon-cyan { box-shadow: 0 0 20px rgba(0, 255, 255, 0.5); }
        .neon-emerald { box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
        .neon-crimson { box-shadow: 0 0 20px rgba(220, 38, 38, 0.5); }
        
        .chip {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            border: 3px solid;
            position: relative;
        }

        .chip:active {
            transform: scale(0.9);
        }

        .chip.selected {
            transform: scale(1.1);
            box-shadow: 0 0 20px currentColor;
        }

        .chip-1k { background: #1f2937; border-color: #374151; color: #fff; }
        .chip-2.5k { background: #b45309; border-color: #d97706; color: #fff; }
        .chip-5k { background: #0369a1; border-color: #0284c7; color: #fff; }
        .chip-25k { background: #991b1b; border-color: #dc2626; color: #fff; }
        .chip-100k { background: #065f46; border-color: #059669; color: #fff; }
        .chip-500k { background: #1f2937; border-color: #6b7280; color: #fff; }
        .chip-1.2m { background: #831843; border-color: #be185d; color: #fff; }
        .chip-5m { background: #1e3a8a; border-color: #2563eb; color: #fff; }

        .chip-500 { background: linear-gradient(135deg, #b45309 0%, #d97706 100%); border-color: #fbbf24; color: #fff; }
        .chip-2500-r { background: linear-gradient(135deg, #b45309 0%, #92400e 100%); border-color: #d97706; color: #fff; }
        .chip-5000 { background: linear-gradient(135deg, #0c4a6e 0%, #0284c7 100%); border-color: #38bdf8; color: #fff; }
        .chip-25000 { background: linear-gradient(135deg, #7f1d1d 0%, #dc2626 100%); border-color: #f87171; color: #fff; }
        .chip-100000 { background: linear-gradient(135deg, #064e3b 0%, #059669 100%); border-color: #34d399; color: #fff; }
        .chip-500000 { background: linear-gradient(135deg, #1f2937 0%, #4b5563 100%); border-color: #9ca3af; color: #fff; }
        .chip-1200000 { background: linear-gradient(135deg, #831843 0%, #be185d 100%); border-color: #f9a8d4; color: #fff; }
        .chip-5000000 { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); border-color: #93c5fd; color: #fff; }

        .number-btn {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.15s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .number-btn:active {
            transform: scale(0.95);
        }

        .number-red {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            border-color: #ef4444;
        }

        .number-black {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            border-color: #374151;
        }

        .number-green {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            border-color: #10b981;
        }

        .pulse-animation {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <div class="glass border-b border-cyan-500/30 px-4 py-3 sticky top-0 z-50">
        <h1 class="text-2xl md:text-3xl font-black text-center bg-gradient-to-r from-cyan-400 via-emerald-400 to-pink-400 bg-clip-text text-transparent">
            NEON PRECISION V18
        </h1>
        <p class="text-center text-xs text-gray-400 mt-1">OFFLINE MASTER ‚Ä¢ ZERO LATENCY</p>
    </div>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto p-2 md:p-4">
        <!-- Game Selector -->
        <div class="flex gap-2 mb-4">
            <button id="btnRoulette" class="flex-1 py-4 rounded-xl font-bold text-lg glass neon-crimson" onclick="switchGame('roulette')">
                üéØ RULETA
            </button>
            <button id="btnBaccarat" class="flex-1 py-4 rounded-xl font-bold text-lg glass" onclick="switchGame('baccarat')">
                üÉè BACCARAT
            </button>
        </div>

        <!-- Status Panel -->
        <div id="statusPanel" class="glass rounded-xl p-4 mb-4 slide-in"></div>

        <!-- Configuration Panel (Hidden by default) -->
        <div id="configPanel" class="glass rounded-xl p-4 mb-4 hidden">
            <h3 class="text-lg font-bold mb-3 text-cyan-400">‚öôÔ∏è CONFIGURACI√ìN</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <div>
                    <label class="text-sm text-gray-400">Capital Inicial</label>
                    <input type="number" id="inputCapital" class="w-full bg-black/50 border border-gray-600 rounded px-3 py-2 text-white" value="1000000">
                </div>
                <div>
                    <label class="text-sm text-gray-400">Meta</label>
                    <input type="number" id="inputTarget" class="w-full bg-black/50 border border-gray-600 rounded px-3 py-2 text-white" value="1500000">
                </div>
                <div>
                    <label class="text-sm text-gray-400">Stop Loss</label>
                    <input type="number" id="inputStopLoss" class="w-full bg-black/50 border border-gray-600 rounded px-3 py-2 text-white" value="500000">
                </div>
            </div>
            <button onclick="applyConfig()" class="mt-3 w-full bg-emerald-600 hover:bg-emerald-700 py-2 rounded-lg font-bold">
                APLICAR
            </button>
        </div>

        <!-- Prediction Panel -->
        <div id="predictionPanel" class="glass rounded-xl p-4 mb-4"></div>

        <!-- Chips Panel -->
        <div id="chipsPanel" class="glass rounded-xl p-4 mb-4"></div>

        <!-- Game Interface -->
        <div id="gameInterface" class="glass rounded-xl p-4 mb-4"></div>

        <!-- Control Buttons -->
        <div class="grid grid-cols-2 gap-2 mb-4">
            <button onclick="toggleConfig()" class="glass py-3 rounded-xl font-bold">
                ‚öôÔ∏è CONFIG
            </button>
            <button onclick="changeCroupier()" class="glass py-3 rounded-xl font-bold text-amber-400">
                üîÑ CAMBIO CRUPIER
            </button>
        </div>

        <!-- Action Buttons -->
        <div class="grid grid-cols-2 gap-2">
            <button onclick="resetSession()" class="bg-red-600/20 border border-red-500 py-3 rounded-xl font-bold text-red-400">
                üóëÔ∏è FINALIZAR SESI√ìN
            </button>
            <button onclick="exportData()" class="bg-blue-600/20 border border-blue-500 py-3 rounded-xl font-bold text-blue-400">
                üìä EXPORTAR
            </button>
        </div>
    </div>

    <script>
        // ============ ESTADO GLOBAL ============
        let currentGame = 'roulette';
        let state = {
            roulette: {
                capital: 1000000,
                initialCapital: 1000000,
                target: 1500000,
                stopLoss: 500000,
                history: [],
                phase: 'collecting', // collecting, ghosting, active, recalibrating
                collectionCount: 0,
                ghostCount: 0,
                recalibrationCount: 0,
                dalembertLevel: 1,
                consecutiveLosses: 0,
                wins: 0,
                losses: 0,
                prediction: null,
                confidence: 0,
                selectedChips: []
            },
            baccarat: {
                capital: 1000000,
                initialCapital: 1000000,
                target: 1500000,
                stopLoss: 500000,
                history: [],
                phase: 'collecting',
                collectionCount: 0,
                ghostCount: 0,
                recalibrationCount: 0,
                sequencePosition: 0, // 1-3-2-4
                consecutiveLosses: 0,
                wins: 0,
                losses: 0,
                prediction: null,
                confidence: 0,
                selectedChips: []
            }
        };

        // Constantes
        const REDS = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
        const SEQUENCE_1324 = [1, 3, 2, 4];
        
        // Fichas Baccarat (imagen 1)
        const CHIPS_BACCARAT = [
            { value: 1000, label: '1K', class: 'chip-1k' },
            { value: 2500, label: '2.5K', class: 'chip-2.5k' },
            { value: 5000, label: '5K', class: 'chip-5k' },
            { value: 25000, label: '25K', class: 'chip-25k' },
            { value: 100000, label: '100K', class: 'chip-100k' },
            { value: 500000, label: '500K', class: 'chip-500k' },
            { value: 1200000, label: '1.2M', class: 'chip-1.2m' },
            { value: 5000000, label: '5M', class: 'chip-5m' }
        ];

        // Fichas Ruleta (imagen 2)
        const CHIPS_ROULETTE = [
            { value: 500, label: '500', class: 'chip-500' },
            { value: 2500, label: '2.5K', class: 'chip-2500-r' },
            { value: 5000, label: '5K', class: 'chip-5000' },
            { value: 25000, label: '25K', class: 'chip-25000' },
            { value: 100000, label: '100K', class: 'chip-100000' },
            { value: 500000, label: '500K', class: 'chip-500000' },
            { value: 1200000, label: '1.2M', class: 'chip-1200000' },
            { value: 5000000, label: '5M', class: 'chip-5000000' }
        ];

        // ============ INICIALIZACI√ìN ============
        function init() {
            loadFromLocalStorage();
            updateUI();
        }

        // ============ LOCALSTORAGE ============
        function saveToLocalStorage() {
            localStorage.setItem('neonPrecisionV18', JSON.stringify(state));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('neonPrecisionV18');
            if (saved) {
                try {
                    state = JSON.parse(saved);
                } catch (e) {
                    console.error('Error loading state:', e);
                }
            }
        }

        // ============ MATEM√ÅTICA - RULETA ============
        function analyzeRoulette(history) {
            if (history.length < 10) {
                return { dozen: null, confidence: 0, reason: 'Datos insuficientes' };
            }

            // Contar frecuencias por docena
            const dozenFreq = { 1: 0, 2: 0, 3: 0, 0: 0 };
            history.forEach(num => {
                const dozen = getDozen(num);
                dozenFreq[dozen]++;
            });

            // Ley del tercio: buscar docena m√°s fr√≠a
            const dozens = [1, 2, 3];
            const coldestDozen = dozens.reduce((a, b) => 
                dozenFreq[a] < dozenFreq[b] ? a : b
            );

            // Calcular d√©ficit
            const avgFreq = dozens.reduce((sum, d) => sum + dozenFreq[d], 0) / 3;
            const deficit = avgFreq - dozenFreq[coldestDozen];

            // Calcular confianza (65% base + d√©ficit)
            let confidence = 65 + (deficit * 3);
            confidence = Math.min(confidence, 95);

            // An√°lisis de zonas calientes
            const recentNumbers = history.slice(-12);
            const recentDozens = recentNumbers.map(getDozen).filter(d => d !== 0);
            const recentFreq = { 1: 0, 2: 0, 3: 0 };
            recentDozens.forEach(d => recentFreq[d]++);

            // Si una docena est√° muy caliente recientemente, reducir confianza
            const maxRecent = Math.max(...Object.values(recentFreq));
            if (maxRecent > 6) {
                confidence *= 0.9;
            }

            return {
                dozen: coldestDozen,
                confidence: Math.round(confidence),
                reason: `D√©ficit: ${deficit.toFixed(1)} apariciones`,
                frequencies: dozenFreq
            };
        }

        function getDozen(num) {
            if (num === 0) return 0;
            if (num <= 12) return 1;
            if (num <= 24) return 2;
            return 3;
        }

        // ============ MATEM√ÅTICA - BACCARAT ============
        function analyzeBaccarat(history) {
            if (history.length < 10) {
                return { side: null, confidence: 0, reason: 'Datos insuficientes' };
            }

            const sides = history.map(h => h.side);
            
            // Contar frecuencias
            const pCount = sides.filter(s => s === 'P').length;
            const bCount = sides.filter(s => s === 'B').length;
            const tCount = sides.filter(s => s === 'T').length;

            // Detectar racha actual
            let streakSide = sides[sides.length - 1];
            let streakCount = 1;
            for (let i = sides.length - 2; i >= 0; i--) {
                if (sides[i] === streakSide && sides[i] !== 'T') {
                    streakCount++;
                } else if (sides[i] !== 'T') {
                    break;
                }
            }

            // Detectar patr√≥n ZigZag
            let zigzagCount = 0;
            for (let i = sides.length - 1; i > 0; i--) {
                if (sides[i] !== 'T' && sides[i-1] !== 'T' && sides[i] !== sides[i-1]) {
                    zigzagCount++;
                } else if (sides[i] !== 'T') {
                    break;
                }
            }

            let prediction = null;
            let confidence = 50;
            let reason = '';

            // L√≥gica de predicci√≥n
            if (streakCount >= 6) {
                // Racha larga: apostar CONTRA
                prediction = streakSide === 'P' ? 'B' : 'P';
                confidence = 60 + Math.min(streakCount - 6, 10) * 2;
                reason = `Ruptura de racha ${streakSide} x${streakCount}`;
            } else if (zigzagCount >= 4) {
                // Patr√≥n ZigZag: continuar alternancia
                prediction = streakSide === 'P' ? 'B' : 'P';
                confidence = 68;
                reason = `Patr√≥n ZigZag detectado`;
            } else {
                // Ventaja matem√°tica: Banker ligeramente mejor
                prediction = 'B';
                confidence = 52;
                reason = 'Ventaja estad√≠stica Banker';
            }

            return {
                side: prediction,
                confidence: Math.round(confidence),
                reason,
                streak: { side: streakSide, count: streakCount },
                frequencies: { P: pCount, B: bCount, T: tCount }
            };
        }

        // ============ GESTI√ìN DE CAPITAL ============
        function calculateBetRoulette() {
            const session = state.roulette;
            const baseUnit = session.capital * 0.01;
            const amount = baseUnit * session.dalembertLevel;
            return Math.round(amount);
        }

        function calculateBetBaccarat() {
            const session = state.baccarat;
            const baseUnit = session.capital * 0.01;
            const multiplier = SEQUENCE_1324[session.sequencePosition];
            const amount = baseUnit * multiplier;
            return Math.round(amount);
        }

        // ============ REGISTRO DE RESULTADOS ============
        function registerRouletteNumber(num) {
            const session = state.roulette;
            session.history.push(num);

            // Mantener ventana deslizante de 37
            if (session.history.length > 37) {
                session.history.shift();
            }

            // FASE 1: COLLECTING
            if (session.phase === 'collecting') {
                session.collectionCount++;
                if (session.collectionCount >= 37) {
                    session.phase = 'ghosting';
                    session.ghostCount = 0;
                }
            }
            // FASE 2: GHOSTING
            else if (session.phase === 'ghosting') {
                const analysis = analyzeRoulette(session.history);
                session.prediction = analysis.dozen;
                session.confidence = analysis.confidence;

                // Verificar acierto en ghost
                const actualDozen = getDozen(num);
                if (actualDozen === session.prediction && actualDozen !== 0) {
                    session.ghostCount += 1.5;
                } else {
                    session.ghostCount += 1;
                }

                if (session.ghostCount >= 10) {
                    // Verificar si la confianza es suficiente
                    if (session.confidence >= 75) {
                        session.phase = 'active';
                    } else {
                        // Seguir en ghosting hasta alcanzar confianza
                        session.ghostCount = 8; // No salir a√∫n
                    }
                }
            }
            // FASE 4: RECALIBRATING
            else if (session.phase === 'recalibrating') {
                const analysis = analyzeRoulette(session.history);
                session.prediction = analysis.dozen;
                session.confidence = analysis.confidence;

                const actualDozen = getDozen(num);
                if (actualDozen === session.prediction && actualDozen !== 0) {
                    session.recalibrationCount += 1.5;
                } else {
                    session.recalibrationCount += 1;
                }

                if (session.recalibrationCount >= 5) {
                    if (session.confidence >= 75) {
                        session.phase = 'active';
                        session.consecutiveLosses = 0;
                    } else {
                        session.recalibrationCount = 3;
                    }
                }
            }
            // FASE 3: ACTIVE
            else if (session.phase === 'active') {
                const analysis = analyzeRoulette(session.history);
                session.prediction = analysis.dozen;
                session.confidence = analysis.confidence;

                // Si hab√≠a una apuesta activa
                if (session.selectedChips.length > 0) {
                    const betAmount = session.selectedChips.reduce((sum, c) => sum + c, 0);
                    const actualDozen = getDozen(num);

                    if (actualDozen === session.prediction && actualDozen !== 0) {
                        // VICTORIA (pago 2:1)
                        session.capital += betAmount * 2;
                        session.dalembertLevel = Math.max(1, session.dalembertLevel - 1);
                        session.consecutiveLosses = 0;
                        session.wins++;
                    } else {
                        // DERROTA
                        session.capital -= betAmount;
                        session.dalembertLevel++;
                        session.consecutiveLosses++;
                        session.losses++;

                        // Protecci√≥n: 3 p√©rdidas consecutivas
                        if (session.consecutiveLosses >= 3) {
                            session.phase = 'recalibrating';
                            session.recalibrationCount = 0;
                        }
                    }

                    session.selectedChips = [];
                }
            }

            saveToLocalStorage();
            updateUI();
        }

        function registerBaccaratSide(side) {
            const session = state.baccarat;
            session.history.push({ side, timestamp: Date.now() });

            // FASE 1: COLLECTING
            if (session.phase === 'collecting') {
                session.collectionCount++;
                if (session.collectionCount >= 15) {
                    session.phase = 'ghosting';
                    session.ghostCount = 0;
                }
            }
            // FASE 2: GHOSTING
            else if (session.phase === 'ghosting') {
                const analysis = analyzeBaccarat(session.history);
                session.prediction = analysis.side;
                session.confidence = analysis.confidence;

                if (side === session.prediction) {
                    session.ghostCount += 1.5;
                } else {
                    session.ghostCount += 1;
                }

                if (session.ghostCount >= 10) {
                    if (session.confidence >= 75) {
                        session.phase = 'active';
                    } else {
                        session.ghostCount = 8;
                    }
                }
            }
            // FASE 4: RECALIBRATING
            else if (session.phase === 'recalibrating') {
                const analysis = analyzeBaccarat(session.history);
                session.prediction = analysis.side;
                session.confidence = analysis.confidence;

                if (side === session.prediction) {
                    session.recalibrationCount += 1.5;
                } else {
                    session.recalibrationCount += 1;
                }

                if (session.recalibrationCount >= 5) {
                    if (session.confidence >= 75) {
                        session.phase = 'active';
                        session.consecutiveLosses = 0;
                    } else {
                        session.recalibrationCount = 3;
                    }
                }
            }
            // FASE 3: ACTIVE
            else if (session.phase === 'active') {
                const analysis = analyzeBaccarat(session.history);
                session.prediction = analysis.side;
                session.confidence = analysis.confidence;

                if (session.selectedChips.length > 0) {
                    const betAmount = session.selectedChips.reduce((sum, c) => sum + c, 0);

                    if (side === 'T') {
                        // EMPATE en modo real: PIERDE
                        session.capital -= betAmount;
                        session.consecutiveLosses++;
                        session.losses++;
                        session.sequencePosition = 0;
                    } else if (side === session.prediction) {
                        // VICTORIA
                        const multiplier = side === 'P' ? 1.1 : 0.9;
                        session.capital += betAmount * multiplier;
                        session.sequencePosition = (session.sequencePosition + 1) % 4;
                        session.consecutiveLosses = 0;
                        session.wins++;
                    } else {
                        // DERROTA
                        session.capital -= betAmount;
                        session.sequencePosition = 0;
                        session.consecutiveLosses++;
                        session.losses++;
                    }

                    if (session.consecutiveLosses >= 3) {
                        session.phase = 'recalibrating';
                        session.recalibrationCount = 0;
                    }

                    session.selectedChips = [];
                }
            }

            saveToLocalStorage();
            updateUI();
        }

        // ============ UI - SELECTOR DE FICHAS ============
        function toggleChip(value) {
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            const idx = session.selectedChips.indexOf(value);
            
            if (idx > -1) {
                session.selectedChips.splice(idx, 1);
            } else {
                session.selectedChips.push(value);
            }

            updateUI();
        }

        function renderChips() {
            const chips = currentGame === 'roulette' ? CHIPS_ROULETTE : CHIPS_BACCARAT;
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            const total = session.selectedChips.reduce((sum, c) => sum + c, 0);

            let html = '<h3 class="text-lg font-bold mb-3 text-cyan-400">üí∞ SELECCI√ìN DE FICHAS</h3>';
            html += `<div class="text-center mb-3"><span class="text-2xl font-bold text-yellow-400">${formatMoney(total)}</span></div>`;
            html += '<div class="flex flex-wrap gap-3 justify-center">';
            
            chips.forEach(chip => {
                const isSelected = session.selectedChips.includes(chip.value);
                html += `
                    <div class="chip ${chip.class} ${isSelected ? 'selected' : ''}" onclick="toggleChip(${chip.value})">
                        ${chip.label}
                    </div>
                `;
            });

            html += '</div>';

            if (session.selectedChips.length > 0) {
                html += `<button onclick="clearChips()" class="mt-3 w-full bg-red-600 py-2 rounded-lg font-bold">LIMPIAR FICHAS</button>`;
            }

            document.getElementById('chipsPanel').innerHTML = html;
        }

        function clearChips() {
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            session.selectedChips = [];
            updateUI();
        }

        // ============ UI - PREDICCI√ìN ============
        function renderPrediction() {
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            let html = '';

            if (session.phase === 'collecting') {
                const target = currentGame === 'roulette' ? 37 : 15;
                const progress = (session.collectionCount / target) * 100;
                html = `
                    <div class="text-center">
                        <div class="text-xl font-bold text-purple-400 mb-2">üìä FASE 1: RECOLECCI√ìN</div>
                        <div class="text-4xl font-bold mb-2">${session.collectionCount}/${target}</div>
                        <div class="w-full bg-gray-700 rounded-full h-4 mb-2">
                            <div class="bg-gradient-to-r from-purple-500 to-pink-500 h-4 rounded-full transition-all" style="width: ${progress}%"></div>
                        </div>
                        <p class="text-sm text-gray-400">Ingresa datos iniciales para calibrar el sistema</p>
                    </div>
                `;
            } else if (session.phase === 'ghosting') {
                const progress = (session.ghostCount / 10) * 100;
                html = `
                    <div class="text-center">
                        <div class="text-xl font-bold text-blue-400 mb-2">üëª FASE 2: MODO FANTASMA</div>
                        <div class="text-4xl font-bold mb-2">${Math.floor(session.ghostCount)}/10</div>
                        <div class="w-full bg-gray-700 rounded-full h-4 mb-2">
                            <div class="bg-gradient-to-r from-blue-500 to-cyan-500 h-4 rounded-full transition-all" style="width: ${progress}%"></div>
                        </div>
                        <div class="mt-3 p-3 bg-blue-900/30 rounded-lg">
                            <div class="text-sm text-gray-300">Predicci√≥n: <span class="font-bold text-white">${session.prediction || 'N/A'}</span></div>
                            <div class="text-sm text-gray-300">Confianza: <span class="font-bold ${session.confidence >= 75 ? 'text-green-400' : 'text-yellow-400'}">${session.confidence}%</span></div>
                        </div>
                        <p class="text-sm text-gray-400 mt-2">Validando precisi√≥n matem√°tica...</p>
                    </div>
                `;
            } else if (session.phase === 'recalibrating') {
                const progress = (session.recalibrationCount / 5) * 100;
                html = `
                    <div class="text-center">
                        <div class="text-xl font-bold text-amber-400 mb-2">‚ö†Ô∏è FASE 4: RECALIBRACI√ìN</div>
                        <div class="text-4xl font-bold mb-2">${Math.floor(session.recalibrationCount)}/5</div>
                        <div class="w-full bg-gray-700 rounded-full h-4 mb-2">
                            <div class="bg-gradient-to-r from-amber-500 to-orange-500 h-4 rounded-full transition-all" style="width: ${progress}%"></div>
                        </div>
                        <p class="text-sm text-red-400 mt-2">Sistema en protecci√≥n tras 3 p√©rdidas consecutivas</p>
                    </div>
                `;
            } else if (session.phase === 'active') {
                const suggestedBet = currentGame === 'roulette' ? calculateBetRoulette() : calculateBetBaccarat();
                
                if (session.confidence >= 75) {
                    html = `
                        <div class="text-center">
                            <div class="text-xl font-bold text-green-400 mb-2 pulse-animation">üî• FASE 3: FUEGO REAL</div>
                            <div class="grid grid-cols-3 gap-3 mb-3">
                                <div class="bg-green-900/30 p-3 rounded-lg">
                                    <div class="text-xs text-gray-400">PREDICCI√ìN</div>
                                    <div class="text-2xl font-bold">${session.prediction || 'N/A'}</div>
                                </div>
                                <div class="bg-green-900/30 p-3 rounded-lg">
                                    <div class="text-xs text-gray-400">CONFIANZA</div>
                                    <div class="text-2xl font-bold text-green-400">${session.confidence}%</div>
                                </div>
                                <div class="bg-green-900/30 p-3 rounded-lg">
                                    <div class="text-xs text-gray-400">SUGERENCIA</div>
                                    <div class="text-2xl font-bold text-yellow-400">${formatMoney(suggestedBet)}</div>
                                </div>
                            </div>
                            <div class="bg-green-600/20 border border-green-500 rounded-lg p-3">
                                <div class="font-bold">‚úÖ AUTORIZADO PARA APOSTAR</div>
                            </div>
                        </div>
                    `;
                } else {
                    html = `
                        <div class="text-center">
                            <div class="text-xl font-bold text-yellow-400 mb-2">‚è≥ ACTIVO - ESPERANDO</div>
                            <div class="text-lg mb-2">Confianza actual: <span class="font-bold">${session.confidence}%</span></div>
                            <div class="bg-yellow-900/30 border border-yellow-500 rounded-lg p-3">
                                <div class="font-bold">‚ö†Ô∏è ESPERAR - Confianza insuficiente (&lt; 75%)</div>
                                <p class="text-sm mt-2">Contin√∫a ingresando resultados para mejorar la precisi√≥n</p>
                            </div>
                        </div>
                    `;
                }
            }

            document.getElementById('predictionPanel').innerHTML = html;
        }

        // ============ UI - ESTADO ============
        function renderStatus() {
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            const profit = session.capital - session.initialCapital;
            const profitPercent = ((profit / session.initialCapital) * 100).toFixed(1);
            const winRate = session.wins + session.losses > 0 ? ((session.wins / (session.wins + session.losses)) * 100).toFixed(0) : 0;

            let phaseColor = '';
            if (session.phase === 'collecting') phaseColor = 'text-purple-400';
            else if (session.phase === 'ghosting') phaseColor = 'text-blue-400';
            else if (session.phase === 'recalibrating') phaseColor = 'text-amber-400';
            else phaseColor = 'text-green-400';

            const html = `
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                    <div class="text-center">
                        <div class="text-xs text-gray-400">CAPITAL</div>
                        <div class="text-2xl font-bold ${profit >= 0 ? 'text-green-400' : 'text-red-400'}">${formatMoney(session.capital)}</div>
                        <div class="text-xs ${profit >= 0 ? 'text-green-400' : 'text-red-400'}">${profit >= 0 ? '+' : ''}${formatMoney(profit)} (${profitPercent}%)</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-400">META</div>
                        <div class="text-xl font-bold text-cyan-400">${formatMoney(session.target)}</div>
                        <div class="text-xs text-gray-400">Stop: ${formatMoney(session.stopLoss)}</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-400">FASE</div>
                        <div class="text-xl font-bold ${phaseColor}">${session.phase.toUpperCase()}</div>
                        <div class="text-xs text-gray-400">Nivel: ${currentGame === 'roulette' ? session.dalembertLevel : session.sequencePosition + 1}/4</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-400">WIN RATE</div>
                        <div class="text-xl font-bold text-purple-400">${winRate}%</div>
                        <div class="text-xs text-gray-400">${session.wins}W / ${session.losses}L</div>
                    </div>
                </div>
            `;

            document.getElementById('statusPanel').innerHTML = html;
        }

        // ============ UI - INTERFAZ DE JUEGO ============
        function renderGameInterface() {
            if (currentGame === 'roulette') {
                renderRouletteGrid();
            } else {
                renderBaccaratButtons();
            }
        }

        function renderRouletteGrid() {
            let html = '<h3 class="text-lg font-bold mb-3 text-center text-cyan-400">üéØ RULETA EUROPEA</h3>';
            
            // N√∫mero 0
            html += '<div class="flex justify-center mb-3">';
            html += '<button class="number-btn number-green" onclick="registerRouletteNumber(0)">0</button>';
            html += '</div>';

            // N√∫meros 1-36
            html += '<div class="grid grid-cols-6 gap-2">';
            for (let i = 1; i <= 36; i++) {
                const colorClass = REDS.includes(i) ? 'number-red' : 'number-black';
                html += `<button class="number-btn ${colorClass}" onclick="registerRouletteNumber(${i})">${i}</button>`;
            }
            html += '</div>';

            document.getElementById('gameInterface').innerHTML = html;
        }

        function renderBaccaratButtons() {
            const html = `
                <h3 class="text-lg font-bold mb-3 text-center text-blue-400">üÉè BACCARAT</h3>
                <div class="grid grid-cols-3 gap-3">
                    <button onclick="registerBaccaratSide('P')" class="bg-gradient-to-br from-blue-600 to-blue-700 py-12 rounded-xl font-bold text-2xl border-2 border-blue-400 hover:scale-105 transition-transform">
                        üîµ<br>PLAYER
                    </button>
                    <button onclick="registerBaccaratSide('B')" class="bg-gradient-to-br from-red-600 to-red-700 py-12 rounded-xl font-bold text-2xl border-2 border-red-400 hover:scale-105 transition-transform">
                        üî¥<br>BANKER
                    </button>
                    <button onclick="registerBaccaratSide('T')" class="bg-gradient-to-br from-green-600 to-green-700 py-12 rounded-xl font-bold text-2xl border-2 border-green-400 hover:scale-105 transition-transform">
                        üü¢<br>TIE
                    </button>
                </div>
                <div class="mt-3 text-center text-xs text-gray-400">
                    <p>Player paga 1.1x ‚Ä¢ Banker paga 0.9x ‚Ä¢ Tie pierde en modo real</p>
                </div>
            `;

            document.getElementById('gameInterface').innerHTML = html;
        }

        // ============ UI - ACTUALIZACI√ìN GENERAL ============
        function updateUI() {
            renderStatus();
            renderPrediction();
            renderChips();
            renderGameInterface();
            updateGameButtons();
        }

        function updateGameButtons() {
            document.getElementById('btnRoulette').className = currentGame === 'roulette' 
                ? 'flex-1 py-4 rounded-xl font-bold text-lg glass neon-crimson'
                : 'flex-1 py-4 rounded-xl font-bold text-lg glass';

            document.getElementById('btnBaccarat').className = currentGame === 'baccarat'
                ? 'flex-1 py-4 rounded-xl font-bold text-lg glass neon-cyan'
                : 'flex-1 py-4 rounded-xl font-bold text-lg glass';
        }

        // ============ CONTROLES ============
        function switchGame(game) {
            currentGame = game;
            updateUI();
        }

        function toggleConfig() {
            const panel = document.getElementById('configPanel');
            panel.classList.toggle('hidden');
            
            if (!panel.classList.contains('hidden')) {
                const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
                document.getElementById('inputCapital').value = session.capital;
                document.getElementById('inputTarget').value = session.target;
                document.getElementById('inputStopLoss').value = session.stopLoss;
            }
        }

        function applyConfig() {
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            
            session.capital = parseInt(document.getElementById('inputCapital').value) || session.capital;
            session.initialCapital = session.capital;
            session.target = parseInt(document.getElementById('inputTarget').value) || session.target;
            session.stopLoss = parseInt(document.getElementById('inputStopLoss').value) || session.stopLoss;

            saveToLocalStorage();
            toggleConfig();
            updateUI();

            alert('‚úÖ Configuraci√≥n aplicada correctamente');
        }

        function changeCroupier() {
            if (!confirm('¬øCambiar crupier/shoe? Esto reiniciar√° el historial y fase actual.')) return;

            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            
            session.history = [];
            session.phase = 'recalibrating';
            session.collectionCount = 0;
            session.ghostCount = 0;
            session.recalibrationCount = 0;
            session.consecutiveLosses = 0;
            session.selectedChips = [];

            saveToLocalStorage();
            updateUI();

            alert('üîÑ Crupier cambiado. Sistema en recalibraci√≥n.');
        }

        function resetSession() {
            if (!confirm('‚ö†Ô∏è ¬øFINALIZAR SESI√ìN? Esto borrar√° TODOS los datos incluyendo el saldo.')) return;
            if (!confirm('¬øEst√°s SEGURO? Esta acci√≥n no se puede deshacer.')) return;

            localStorage.removeItem('neonPrecisionV18');
            location.reload();
        }

        function exportData() {
            const session = currentGame === 'roulette' ? state.roulette : state.baccarat;
            const data = {
                game: currentGame,
                timestamp: new Date().toISOString(),
                capital: session.capital,
                profit: session.capital - session.initialCapital,
                wins: session.wins,
                losses: session.losses,
                phase: session.phase,
                history: session.history
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `neon-precision-${currentGame}-${Date.now()}.json`;
            a.click();

            alert('üìä Datos exportados correctamente');
        }

        function formatMoney(amount) {
            if (amount >= 1000000) {
                return `${(amount / 1000000).toFixed(1)}M`;
            } else if (amount >= 1000) {
                return `${(amount / 1000).toFixed(0)}K`;
            }
            return `${amount.toFixed(0)}`;
        }

        // ============ INICIAR APLICACI√ìN ============
        window.onload = init;
    </script>
</body>
</html>
